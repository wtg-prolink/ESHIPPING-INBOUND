<?xml version="1.0" encoding="utf-8"?>
<root>
  <Table name="SMSM"  sql="SELECT A.*,
(SELECT TOP 1 SHPR_NM FROM SMSIM WHERE SMSIM.[PROFILE]=A.PROFILE_CD) AS SHPR_NM,
(SELECT TOP 1 COMMODITY FROM SMSIM WHERE SMSIM.[PROFILE]=A.PROFILE_CD) AS SI_COMMODITY,
(SELECT TOP 1 ISNULL(CD_DESCP,A.PKG_UNIT) FROM BSCODE WHERE  BSCODE.CD_TYPE='UB' AND  BSCODE.CD=A.PKG_UNIT AND  BSCODE.GROUP_ID=A.GROUP_ID) PKG_UNIT_UB,
(SELECT TOP 1 CHG_DESCP FROM SMCHG WHERE CHG_CD=A.QTYU) QTYU_DESCP,
(SELECT SUM(AMOUNT1) FROM SMDN WHERE SMDN.SHIPMENT_ID=A.SHIPMENT_ID) AMOUNT1,
(SELECT TOP (1) PARTY_NAME FROM SMSMPT WHERE SHIPMENT_ID=A.SHIPMENT_ID AND PARTY_TYPE ='FS') FS_NAME,
(SELECT TOP (1) PARTY_NAME FROM SMSMPT WHERE SHIPMENT_ID=A.SHIPMENT_ID AND PARTY_TYPE ='SP') SP_NAME
FROM SMSM A WHERE A.SHIPMENT_ID=':=shipid' AND A.TRAN_TYPE='A'">	
	</Table>
   <Table name="SMDNP"  sql="SELECT SMDNP.* FROM SMDNP WHERE DN_NO IN(SELECT DN_NO FROM SMDN WHERE SHIPMENT_ID=':=shipid')">	
	</Table>
  <Table name="SMSMPT" sql="SELECT B.*,E.AC_NO,
 (SELECT TOP 1 TAX_NO FROM SMPTY WHERE PARTY_NO=B.PARTY_NO) TAX_NO,
(SELECT TOP 1 PARTY_NAME FROM SMPTY WHERE PARTY_NO=B.PARTY_NO) PARTY_NAME1,
(SELECT TOP 1 PARTY_NAME2 FROM SMPTY WHERE PARTY_NO=B.PARTY_NO) PARTY_NAME2,
(SELECT TOP 1 PARTY_NAME3 FROM SMPTY WHERE PARTY_NO=B.PARTY_NO) PARTY_NAME3,
(SELECT TOP 1 PARTY_NAME4 FROM SMPTY WHERE PARTY_NO=B.PARTY_NO) PARTY_NAME4,
(SELECT TOP (1) PART_ADDR1 FROM SMPTY WHERE PARTY_NO=B.PARTY_NO ) TITLE_ADDR1,
(SELECT TOP (1) PARTY_NAME FROM SMPTY WHERE PARTY_NO=B.PARTY_NO ) TITLE_NAME
FROM SMSMPT B LEFT JOIN SMEX_ACCT E ON B.PARTY_NO=E.EXPRESS_CD WHERE B.SHIPMENT_ID=':=shipid'"></Table>
</root>

