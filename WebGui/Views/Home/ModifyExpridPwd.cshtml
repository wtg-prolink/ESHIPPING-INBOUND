@{
    Layout = null;
    ViewBag.Title = "ModifyExpridPwd";
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Login Page - @ViewBag.SYS_TITLE</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <link href="@Url.Content("~/Scripts/Core/bui/css/bootstrap.min.css")" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Scripts/Core/bui/css/jquery-ui.css")" />
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Scripts/Core/bui/css/Modify.css")" />
    <link href="@Url.Content("~/Scripts/css/common.css")" rel="stylesheet" />

    <script type="text/javascript" src="@Url.Content("~/Scripts/Core/bui/js/lib/jquery-1.11.1.min.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/Core/bui/js/lib/bootstrap.min.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/Core/bui/js/lib/jquery-ui.min.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/lib/handlebars.js")"></script>
    <script src="~/Scripts/lang.js?20241106"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/common.js?20240418")"></script>
    <script type="text/javascript">
        var rootPath;
        $(document).ready(function ($) {
            var Lang = "@ViewBag.Lang";
            alert("@Resources.Locale.L_HomeController_Pwdtimetout");
            rootPath = "@Url.Content("~")" + Lang + "/";
            var userid = "@ViewBag.userid";
            var Cmp = "@ViewBag.Cmp";
            $("#lang").val(Lang);
            $("#cmp").val(Cmp);
            $("#userid").val(userid);
            var initLang = true;
            try {
                GetLangCaption("test", "test");
            }
            catch (e) { initLang = false; }
            if (initLang) {
                $("[langId]").each(function () {
                    var jq = $(this);
                    var caption = jq.text() || '';
                    var langId = jq.attr("langId");
                    if (langId == undefined || langId === "" || langId == null)
                        return;
                    caption = GetLangCaption(langId, caption);
                    if (caption == undefined || caption === "" || caption == null)
                        return;
                    jq.text(caption);
                });
            }
            //if (FailCount > 2) {
            //    $("#VerificationCode").show();
            //} else {
            //    $("#VerificationCode").hide();
            //}

            //if (FailMessage != "") {
            //    alert(FailMessage);
            //}

            @*$('#modifyform').on('submit', function (e) {
            //function Submitform(){
                var pass = false;
                var Oripwd= $("#Oripwd").val();
                var npwd= $("#password").val();
                var cpwd= $("#Confirmpassword").val();
            var userid = $("#userid").val();
            var cmp = $("#cmp").val();
                if (Oripwd == "") {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Opwd"); 
                    return false;
                }
                if (npwd == "") {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Npwd");
                    return false;
                }
                if (cpwd == "") {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Cpwd");
                    return false;
                }
                if (npwd != cpwd)
                {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Npwdcompare");
                    $("#Confirmpassword").val("");
                    $("#Confirmpassword").focus();
                    return false;
                }
                else if (Oripwd == npwd) {
                    $("#password").val("");
                    $("#password").focus();
                    $("#Confirmpassword").val("");
                    alert("@Resources.Locale.L_ModifyExpridPwd_Opwdcompare"); 
                    return false;
                }
                $.ajax({
                    async: false,
                    url: rootPath + "/Common/ModifyExpridPwd",
                    type: 'POST',
                    data: { "Oripwd": Oripwd, "npwd": npwd, "cpwd": cpwd, "userid": userid, "cmp": cmp },
                    dataType: "json",
                    "beforeSend": function (xhr) {
                        CommonFunc.ToogleLoading(true);
                        $("go").attr('disabled', true);
                    },
                    "complete": function (xmlHttpRequest, successMsg) {

                    },
                    "error": function (xmlHttpRequest, errMsg) {

                    },
                    success: function (result) {

                        if (result.message == "Y") {
                            //alert("", "TPV ACCOUNT 驗證成功");
                            window.location.href = rootPath + "/Home/Login";
                        } else {
                            alert(result.message);
                            return false;
                        }
                    }
                });

            }
            );*@
        });
        function Submitform() {
            var pass = false;
            var Oripwd = $("#Oripwd").val();
            var npwd = $("#password").val();
            var cpwd = $("#Confirmpassword").val();
            var userid = $("#userid").val();
            var cmp = $("#cmp").val();
            if (Oripwd == "") {
                alert("@Resources.Locale.L_ModifyExpridPwd_Opwd");
                    return false;
                }
                if (npwd == "") {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Npwd");
                    return false;
                }
                if (cpwd == "") {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Cpwd");
                    return false;
                }
                if (npwd != cpwd) {
                    alert("@Resources.Locale.L_ModifyExpridPwd_Npwdcompare");
                    $("#Confirmpassword").val("");
                    $("#Confirmpassword").focus();
                    return false;
                }
                else if (Oripwd == npwd) {
                    $("#password").val("");
                    $("#password").focus();
                    $("#Confirmpassword").val("");
                    alert("@Resources.Locale.L_ModifyExpridPwd_Opwdcompare");
                    return false;
                }
            $.ajax({
                async: false,
                url: rootPath + "Common/ModifyExprid",
                type: 'POST',
                data: { "Oripwd": Oripwd, "npwd": npwd, "cpwd": cpwd, "userid": userid, "cmp": cmp },
                dataType: "json",
                "beforeSend": function (xhr) {
                    CommonFunc.ToogleLoading(true);
                    $("go").attr('disabled', true);
                },
                "complete": function (xmlHttpRequest, successMsg) {

                },
                "error": function (xmlHttpRequest, errMsg) {

                },
                success: function (result) {

                    if (result.message == "Y") {
                        alert("@Resources.Locale.L_Login_Relogin");
                        window.location.href = rootPath + "/Home/Login";
                    } else {
                        alert(result.message);
                        return false;
                    }
                }
            });

        }
    </script>
</head>
<body style="background-color: #BFBEBE;">
    <div class="container">
        <div class="row" id="pwd-container">
            <div class="col-md-4"></div>
            <div class="col-md-4">
                <section class="login-form">
                    @*<form method="post" action="" role="login" novalidate id="modifyform">*@
                    <div class="modifyclass">
                        <h3 style="font-weight: 600;">
                            <img src="@Url.Content("~/Images/sd_logo_2.png")" style="height:27px; float:left;" />@ViewBag.SYS_TITLE
                            
                        </h3>
                        <p style="font-size: 10px;">Version @ViewBag.SYS_VERSION</p>
                        <h3 style="font-weight: 500; text-align:center;" langId="L_ModifyExpridPwd_PWDModify">@Resources.Locale.L_ModifyExpridPwd_PWDModify</h3>
                        <!-- <img src="~/Bootstrap/assets/img/logo.png" class="img-responsive" alt="" /> -->
                        <h2 style="text-align:center;"></h2>
                        <input type="password" name="Oripwd" id="Oripwd"  placeholder="Original password" class="form-control input-lg" value="" required />
                        <input type="password" name="password" id="password"  class="form-control input-lg" id="password" placeholder="New password" required="" />
                         <input type="password" name="Confirmpassword" id="Confirmpassword"  class="form-control input-lg"  placeholder="Confirm new password" required="" />
                        <input type="hidden" name="tpvMsg" id="tpvMsg" />
                        <input type="hidden" name="userid" id="userid" />
                        <input type="hidden" name="lang" id="lang" />
                        <input type="hidden" name="cmp" id="cmp" />
                        @*<fieldset id="VerificationCode">
                            <legend>Verification Codes</legend>
                            <img src="@Url.Action("VerificationCode")" alt="verification codes" />
                            <input type="text" name="InputCode" placeholder="please enter verification code(Capitalization does not matter)" class="form-control input-lg" value="" required />
                        </fieldset>*@
                        <div class="pwstrength_viewport_progress"></div>
                        <p style="color: red; font-size: 10px;">*Use IE10.0 above, or Google Chrome Browser</p>
                        <button type="button" name="go" onclick="Submitform()" class="btn btn-lg btn-primary btn-block">Submit</button>
                        @*<button type="submit" name="go" class="btn btn-lg btn-primary btn-block">Submit</button>*@
@*</form>*@

                    <div class="form-links">
                        <p style="color:#fff;">Copyright © 2016 Prolink Solutions All Rights Reserved.</p>
                    </div>
                        </div>
                </section>
            </div>

            <div class="col-md-4"></div>
        </div>
    </div>
</body>
</html>
